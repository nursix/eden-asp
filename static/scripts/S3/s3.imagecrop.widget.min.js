/*
 jQuery Color Animations v2.0pre
 http://jquery.org/

 Copyright 2011 John Resig
 Dual licensed under the MIT or GPL Version 2 licenses.
 http://jquery.org/license
*/
(function(l,F){function L(b,n,f){var e=S[n.type]||{};if((n.empty||f)&&b==null)return null;if(n.def&&b==null)return n.def;b=e.floor?~~b:parseFloat(b);return b==null||isNaN(b)?n.def:e.mod?(b%=e.mod,b<0?e.mod+b:b):e.min>b?e.min:e.max<b?e.max:b}function z(b){var n=G(),f=n._rgba=[];b=b.toLowerCase();M(aa,function(e,w){e=(e=w.re.exec(b))&&w.parse(e);var B=w.space||"rgba";w=V[B].cache;if(e)return e=n[B](e),n[w]=e[w],f=n._rgba=e._rgba,!1});if(f.length!==0)return Math.max.apply(Math,f)===0&&l.extend(f,ca.transparent),
n;if(b=ca[b])return b}function Y(b,n,f){f=(f+1)%1;return f*6<1?b+(n-b)*6*f:f*2<1?n:f*3<2?b+(n-b)*(2/3-f)*6:b}var Z=/^([\-+])=\s*(\d+\.?\d*)/,aa=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(b){return[b[1],b[2],b[3],b[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(b){return[2.55*b[1],2.55*b[2],2.55*b[3],b[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,
parse:function(b){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(b){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(b){return[b[1],b[2]/100,b[3]/100,b[4]]}}],G=l.Color=function(b,n,f,e){return new l.Color.fn.parse(b,n,f,e)},V={rgba:{cache:"_rgba",props:{red:{idx:0,
type:"byte",empty:!0},green:{idx:1,type:"byte",empty:!0},blue:{idx:2,type:"byte",empty:!0},alpha:{idx:3,type:"percent",def:1}}},hsla:{cache:"_hsla",props:{hue:{idx:0,type:"degrees",empty:!0},saturation:{idx:1,type:"percent",empty:!0},lightness:{idx:2,type:"percent",empty:!0}}}},S={"byte":{floor:!0,min:0,max:255},percent:{min:0,max:1},degrees:{mod:360,floor:!0}},ea=V.rgba.props,fa=G.support={},M=l.each;V.hsla.props.alpha=ea.alpha;G.fn=G.prototype={constructor:G,parse:function(b,n,f,e){if(b===F)return this._rgba=
[null,null,null,null],this;if(b instanceof l||b.nodeType)b=b instanceof l?b.css(n):l(b).css(n),n=F;var w=this,B=l.type(b),H=this._rgba=[];n!==F&&(b=[b,n,f,e],B="array");if(B==="string")return this.parse(z(b)||ca._default);if(B==="array")return M(ea,function(J,x){H[x.idx]=L(b[x.idx],x)}),this;if(B==="object")return b instanceof G?M(V,function(J,x){b[x.cache]&&(w[x.cache]=b[x.cache].slice())}):M(V,function(J,x){M(x.props,function(E,a){var g=x.cache;if(!w[g]&&x.to){if(b[E]==null||E==="alpha")return;
w[g]=x.to(w._rgba)}w[g][a.idx]=L(b[E],a,!0)})}),this},is:function(b){var n=G(b),f=!0,e=this;M(V,function(w,B){var H=n[B.cache];if(H){var J=e[B.cache]||B.to&&B.to(e._rgba)||[];M(B.props,function(x,E){if(H[E.idx]!=null)return f=H[E.idx]===J[E.idx]})}return f});return f},_space:function(){var b=[],n=this;M(V,function(f,e){n[e.cache]&&b.push(f)});return b.pop()},transition:function(b,n){var f=G(b);b=f._space();var e=V[b],w=this[e.cache]||e.to(this._rgba),B=w.slice();f=f[e.cache];M(e.props,function(H,
J){H=J.idx;var x=w[H],E=f[H],a=S[J.type]||{};E!==null&&(x===null?B[H]=E:(a.mod&&(E-x>a.mod/2?x+=a.mod:x-E>a.mod/2&&(x-=a.mod)),B[J.idx]=L((E-x)*n+x,J)))});return this[b](B)},blend:function(b){if(this._rgba[3]===1)return this;var n=this._rgba.slice(),f=n.pop(),e=G(b)._rgba;return G(l.map(n,function(w,B){return(1-f)*e[B]+f*w}))},toRgbaString:function(){var b="rgba(",n=l.map(this._rgba,function(f,e){return f==null?e>2?1:0:f});n[3]===1&&(n.pop(),b="rgb(");return b+n.join(",")+")"},toHslaString:function(){var b=
"hsla(",n=l.map(this.hsla(),function(f,e){f==null&&(f=e>2?1:0);e&&e<3&&(f=Math.round(f*100)+"%");return f});n[3]===1&&(n.pop(),b="hsl(");return b+n.join(",")+")"},toHexString:function(b){var n=this._rgba.slice(),f=n.pop();b&&n.push(~~(f*255));return"#"+l.map(n,function(e,w){e=(e||0).toString(16);return e.length===1?"0"+e:e}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}};G.fn.parse.prototype=G.fn;V.hsla.to=function(b){if(b[0]==null||b[1]==null||b[2]==null)return[null,
null,null,b[3]];var n=b[0]/255,f=b[1]/255,e=b[2]/255;b=b[3];var w=Math.max(n,f,e),B=Math.min(n,f,e),H=w-B,J=w+B,x=J*.5;return[Math.round(B===w?0:n===w?60*(f-e)/H+360:f===w?60*(e-n)/H+120:60*(n-f)/H+240)%360,x===0||x===1?x:x<=.5?H/J:H/(2-J),x,b==null?1:b]};V.hsla.from=function(b){if(b[0]==null||b[1]==null||b[2]==null)return[null,null,null,b[3]];var n=b[0]/360,f=b[1],e=b[2];b=b[3];f=e<=.5?e*(1+f):e+f-e*f;e=2*e-f;return[Math.round(Y(e,f,n+1/3)*255),Math.round(Y(e,f,n)*255),Math.round(Y(e,f,n-1/3)*255),
b]};M(V,function(b,n){var f=n.props,e=n.cache,w=n.to,B=n.from;G.fn[b]=function(H){w&&!this[e]&&(this[e]=w(this._rgba));if(H===F)return this[e].slice();var J=l.type(H),x=J==="array"||J==="object"?H:arguments,E=this[e].slice();M(f,function(g,C){g=x[J==="object"?g:C.idx];g==null&&(g=E[C.idx]);E[C.idx]=L(g,C)});if(B){var a=G(B(E));a[e]=E;return a}return G(E)};M(f,function(H,J){G.fn[H]||(G.fn[H]=function(x){var E=l.type(x),a=H==="alpha"?this._hsla?"hsla":"rgba":b,g=this[a](),C=g[J.idx];if(E==="undefined")return C;
E==="function"&&(x=x.call(this,C),E=l.type(x));if(x==null&&J.empty)return this;E==="string"&&(E=Z.exec(x))&&(x=C+parseFloat(E[2])*(E[1]==="+"?1:-1));g[J.idx]=x;return this[a](g)})})});M("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color outlineColor".split(" "),function(b,n){l.cssHooks[n]={set:function(f,e){var w;if(l.type(e)!=="string"||(w=z(e))){e=G(w||e);if(!fa.rgba&&e._rgba[3]!==1){var B=n==="backgroundColor"?f.parentNode:f;do w=l.curCSS(B,"backgroundColor");
while((w===""||w==="transparent")&&(B=B.parentNode)&&B.style);e=e.blend(w&&w!=="transparent"?w:"_default")}e=e.toRgbaString()}f.style[n]=e}};l.fx.step[n]=function(f){f.colorInit||(f.start=G(f.elem,n),f.end=G(f.end),f.colorInit=!0);l.cssHooks[n].set(f.elem,f.start.transition(f.end,f.pos))}});l(function(){var b=document.createElement("div").style;b.cssText="background-color:rgba(1,1,1,.5)";fa.rgba=b.backgroundColor.indexOf("rgba")>-1});var ca=l.Color.names={aqua:"#00ffff",azure:"#f0ffff",beige:"#f5f5dc",
black:"#000000",blue:"#0000ff",brown:"#a52a2a",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkviolet:"#9400d3",fuchsia:"#ff00ff",gold:"#ffd700",green:"#008000",indigo:"#4b0082",khaki:"#f0e68c",lightblue:"#add8e6",lightcyan:"#e0ffff",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightyellow:"#ffffe0",
lime:"#00ff00",magenta:"#ff00ff",maroon:"#800000",navy:"#000080",olive:"#808000",orange:"#ffa500",pink:"#ffc0cb",purple:"#800080",violet:"#800080",red:"#ff0000",silver:"#c0c0c0",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);
(function(l){l.Jcrop=function(F,L){function z(c){return Math.round(c)+"px"}function Y(c){c=l(c).offset();return[c.left,c.top]}function Z(c){return[c.pageX-pa[0],c.pageY-pa[1]]}function aa(c){typeof c!=="object"&&(c={});a=l.extend(a,c);l.each(["onChange","onSelect","onRelease","onDblClick"],function(t,q){typeof a[q]!=="function"&&(a[q]=function(){})})}function G(c,t,q){pa=Y(I);ja.setCursor(c==="move"?c:c+"-resize");if(c==="move")return ja.activateHandlers(S(t),b,q);t=N.getFixed();var A=ea(c),h=N.getCorner(ea(A));
N.setPressed(N.getCorner(A));N.setCurrent(h);ja.activateHandlers(V(c,t),b,q)}function V(c,t){return function(q){if(a.aspectRatio)switch(c){case "e":q[1]=t.y+1;break;case "w":q[1]=t.y+1;break;case "n":q[0]=t.x+1;break;case "s":q[0]=t.x+1}else switch(c){case "e":q[1]=t.y2;break;case "w":q[1]=t.y2;break;case "n":q[0]=t.x2;break;case "s":q[0]=t.x2}N.setCurrent(q);D.update()}}function S(c){var t=c;Ba.watchKeys();return function(q){N.moveOffset([q[0]-t[0],q[1]-t[1]]);t=q;D.update()}}function ea(c){switch(c){case "n":return"sw";
case "s":return"nw";case "e":return"nw";case "w":return"ne";case "ne":return"sw";case "nw":return"se";case "se":return"nw";case "sw":return"ne"}}function fa(c){return function(t){if(a.disabled||c==="move"&&!a.allowMove)return!1;pa=Y(I);qa=!0;G(c,Z(t));t.stopPropagation();t.preventDefault();return!1}}function M(c,t,q){var A=c.width(),h=c.height();A>t&&t>0&&(A=t,h=t/c.width()*c.height());h>q&&q>0&&(h=q,A=q/c.height()*c.width());W=c.width()/A;ba=c.height()/h;c.width(A).height(h)}function ca(c){return{x:c.x*
W,y:c.y*ba,x2:c.x2*W,y2:c.y2*ba,w:c.w*W,h:c.h*ba}}function b(c){c=N.getFixed();c.w>a.minSelect[0]&&c.h>a.minSelect[1]?(D.enableHandles(),D.done()):D.release();ja.setCursor(a.allowSelect?"crosshair":"default")}function n(c){if(a.disabled||!a.allowSelect)return!1;qa=!0;pa=Y(I);D.disableHandles();ja.setCursor("crosshair");var t=Z(c);N.setPressed(t);D.update();ja.activateHandlers(f,b,c.type.substring(0,5)==="touch");Ba.watchKeys();c.stopPropagation();c.preventDefault();return!1}function f(c){N.setCurrent(c);
D.update()}function e(){var c=l("<div></div>").addClass(a.baseClass+"-tracker");C&&c.css({opacity:0,backgroundColor:"white"});return c}function w(c){B([c[0]/W,c[1]/ba,c[2]/W,c[3]/ba]);a.onSelect.call(ha,ca(N.getFixed()));D.enableHandles()}function B(c){N.setPressed([c[0],c[1]]);N.setCurrent([c[2],c[3]]);D.update()}function H(){a.disabled=!0;D.disableHandles();D.setCursor("default");ja.setCursor("default")}function J(){a.disabled=!1;E()}function x(c,t,q){t=t||a.bgColor;a.bgFade&&l.fx.step.hasOwnProperty("backgroundColor")&&
a.fadeTime&&!q?c.animate({backgroundColor:t},{queue:!1,duration:a.fadeTime}):c.css("backgroundColor",t)}function E(c){a.allowResize?c?D.enableOnly():D.enableHandles():D.disableHandles();ja.setCursor(a.allowSelect?"crosshair":"default");D.setCursor(a.allowMove?"move":"default");a.hasOwnProperty("trueSize")&&(W=a.trueSize[0]/O,ba=a.trueSize[1]/K);a.hasOwnProperty("setSelect")&&(w(a.setSelect),D.done(),delete a.setSelect);ma.refresh();a.bgColor!=Da&&(x(a.shade?ma.getShades():ka,a.shade?a.shadeColor||
a.bgColor:a.bgColor),Da=a.bgColor);va!=a.bgOpacity&&(va=a.bgOpacity,a.shade?ma.refresh():D.setBgOpacity(va));wa=a.maxSize[0]||0;xa=a.maxSize[1]||0;ya=a.minSize[0]||0;za=a.minSize[1]||0;a.hasOwnProperty("outerImage")&&(I.attr("src",a.outerImage),delete a.outerImage);D.refresh()}var a=l.extend({},l.Jcrop.defaults),g=navigator.userAgent.toLowerCase(),C=/msie/.test(g),Q=/msie [1-6]\./.test(g);typeof F!=="object"&&(F=l(F)[0]);typeof L!=="object"&&(L={});aa(L);L={border:"none",visibility:"visible",margin:0,
padding:0,position:"absolute",top:0,left:0};var y=l(F);g=!0;if(F.tagName=="IMG"){if(y[0].width!=0&&y[0].height!=0)y.width(y[0].width),y.height(y[0].height);else{var ra=new Image;ra.src=y[0].src;y.width(ra.width);y.height(ra.height)}var I=y.clone().removeAttr("id").css(L).show();I.width(y.width());I.height(y.height());y.after(I).hide()}else I=y.css(L).show(),g=!1,a.shade===null&&(a.shade=!0);M(I,a.boxWidth,a.boxHeight);var O=I.width(),K=I.height(),ka=l("<div />").width(O).height(K).addClass(a.baseClass+
"-holder").css({position:"relative",backgroundColor:a.bgColor}).insertAfter(y).append(I);a.addClass&&ka.addClass(a.addClass);var na=l("<div />"),Aa=l("<div />").width("100%").height("100%").css({zIndex:310,position:"absolute",overflow:"hidden"}),sa=l("<div />").width("100%").height("100%").css("zIndex",320),ta=l("<div />").css({position:"absolute",zIndex:600}).dblclick(function(){var c=N.getFixed();a.onDblClick.call(ha,c)}).insertBefore(I).append(Aa,sa);g&&(na=l("<img />").attr("src",I.attr("src")).css(L).width(O).height(K),
Aa.append(na));Q&&ta.css({overflowY:"hidden"});var ua=a.boundary,oa=e().width(O+ua*2).height(K+ua*2).css({position:"absolute",top:z(-ua),left:z(-ua),zIndex:290}).mousedown(n),Da=a.bgColor,va=a.bgOpacity,wa,xa,ya,za,W,ba,qa,Ca,Ea;var pa=Y(I);var ia=function(){function c(){var q={},A=["touchstart","touchmove","touchend"],h=document.createElement("div"),m;try{for(m=0;m<A.length;m++){var v=A[m];v="on"+v;var r=v in h;r||(h.setAttribute(v,"return;"),r=typeof h[v]=="function");q[A[m]]=r}return q.touchstart&&
q.touchend&&q.touchmove}catch(X){return!1}}var t=a.touchSupport===!0||a.touchSupport===!1?a.touchSupport:c();return{createDragger:function(q){return function(A){if(a.disabled||q==="move"&&!a.allowMove)return!1;pa=Y(I);qa=!0;G(q,Z(ia.cfilter(A)),!0);A.stopPropagation();A.preventDefault();return!1}},newSelection:function(q){return n(ia.cfilter(q))},cfilter:function(q){q.pageX=q.originalEvent.changedTouches[0].pageX;q.pageY=q.originalEvent.changedTouches[0].pageY;return q},isSupported:c,support:t}}(),
N=function(){function c(){if(!a.aspectRatio){var d=v-h,u=r-m;wa&&Math.abs(d)>wa&&(v=d>0?h+wa:h-wa);xa&&Math.abs(u)>xa&&(r=u>0?m+xa:m-xa);za/ba&&Math.abs(u)<za/ba&&(r=u>0?m+za/ba:m-za/ba);ya/W&&Math.abs(d)<ya/W&&(v=d>0?h+ya/W:h-ya/W);h<0&&(v-=h,h-=h);m<0&&(r-=m,m-=m);v<0&&(h-=v,v-=v);r<0&&(m-=r,r-=r);v>O&&(d=v-O,h-=d,v-=d);r>K&&(d=r-K,m-=d,r-=d);h>O&&(d=h-K,r-=d,m-=d);m>K&&(d=m-K,r-=d,m-=d);return A(q(h,m,v,r))}d=a.aspectRatio;u=a.minSize[0]/W;var R=a.maxSize[0]/W,P=v-h,da=r-m,p=Math.abs(P),k=Math.abs(da);
R===0&&(R=O*10);p/k<d?(p=r,k*=d,k=P<0?h-k:k+h,k<0?(k=0,p=Math.abs((k-h)/d),p=da<0?m-p:p+m):k>O&&(k=O,p=Math.abs((k-h)/d),p=da<0?m-p:p+m)):(k=v,p/=d,p=da<0?m-p:m+p,p<0?(p=0,k=Math.abs((p-m)*d),k=P<0?h-k:k+h):p>K&&(p=K,k=Math.abs(p-m)*d,k=P<0?h-k:k+h));k>h?(k-h<u?k=h+u:k-h>R&&(k=h+R),p=p>m?m+(k-h)/d:m-(k-h)/d):k<h&&(h-k<u?k=h-u:h-k>R&&(k=h-R),p=p>m?m+(h-k)/d:m-(h-k)/d);k<0?(h-=k,k=0):k>O&&(h-=k-O,k=O);p<0?(m-=p,p=0):p>K&&(m-=p-K,p=K);return A(q(h,m,k,p))}function t(d){d[0]<0&&(d[0]=0);d[1]<0&&(d[1]=
0);d[0]>O&&(d[0]=O);d[1]>K&&(d[1]=K);return[Math.round(d[0]),Math.round(d[1])]}function q(d,u,R,P){var da=d,p=R,k=u,T=P;R<d&&(da=R,p=d);P<u&&(k=P,T=u);return[da,k,p,T]}function A(d){return{x:d[0],y:d[1],x2:d[2],y2:d[3],w:d[2]-d[0],h:d[3]-d[1]}}var h=0,m=0,v=0,r=0,X,U;return{flipCoords:q,setPressed:function(d){d=t(d);v=h=d[0];r=m=d[1]},setCurrent:function(d){d=t(d);X=d[0]-v;U=d[1]-r;v=d[0];r=d[1]},getOffset:function(){return[X,U]},moveOffset:function(d){var u=d[0];d=d[1];0>h+u&&(u-=u+h);0>m+d&&(d-=
d+m);K<r+d&&(d+=K-(r+d));O<v+u&&(u+=O-(v+u));h+=u;v+=u;m+=d;r+=d},getCorner:function(d){var u=c();switch(d){case "ne":return[u.x2,u.y];case "nw":return[u.x,u.y];case "se":return[u.x2,u.y2];case "sw":return[u.x,u.y2]}},getFixed:c}}(),ma=function(){function c(){return t(N.getFixed())}function t(u){d.top.css({left:z(u.x),width:z(u.w),height:z(u.y)});d.bottom.css({top:z(u.y2),left:z(u.x),width:z(u.w),height:z(K-u.y2)});d.right.css({left:z(u.x2),width:z(O-u.x2)});d.left.css({width:z(u.x)})}function q(){return l("<div />").css({position:"absolute",
backgroundColor:a.shadeColor||a.bgColor}).appendTo(U)}function A(){X||(X=!0,U.insertBefore(I),c(),D.setBgOpacity(1,0,1),na.hide(),h(a.shadeColor||a.bgColor,1),D.isAwake()?v(a.bgOpacity,1):v(1,1))}function h(u,R){x(r(),u,R)}function m(){X&&(U.remove(),na.show(),X=!1,D.isAwake()?D.setBgOpacity(a.bgOpacity,1,1):(D.setBgOpacity(1,1,1),D.disableHandles()),x(ka,0,1))}function v(u,R){X&&(a.bgFade&&!R?U.animate({opacity:1-u},{queue:!1,duration:a.fadeTime}):U.css({opacity:1-u}))}function r(){return U.children()}
var X=!1,U=l("<div />").css({position:"absolute",zIndex:240,opacity:0}),d={top:q(),left:q().height(K),right:q().height(K),bottom:q()};return{update:c,updateRaw:t,getShades:r,setBgColor:h,enable:A,disable:m,resize:function(u,R){d.left.css({height:z(R)});d.right.css({height:z(R)})},refresh:function(){a.shade?A():m();D.isAwake()&&v(a.bgOpacity)},opacity:v}}(),D=function(){function c(p,k){k=l("<div />").mousedown(fa(p)).css({cursor:p+"-resize",position:"absolute",zIndex:k}).addClass("ord-"+p);ia.support&&
k.bind("touchstart.jcrop",ia.createDragger(p));sa.append(k);return k}function t(p){var k;for(k=0;k<p.length;k++)c(p[k],R++).addClass("jcrop-dragbar")}function q(p){var k;for(k=0;k<p.length;k++){switch(p[k]){case "n":var T="hline";break;case "s":T="hline bottom";break;case "e":T="vline right";break;case "w":T="vline"}var la=T;la=l("<div />").css({position:"absolute",opacity:a.borderOpacity}).addClass(a.baseClass+"-"+la);Aa.append(la)}}function A(p){var k;for(k=0;k<p.length;k++){var T=a.handleSize,
la=c(p[k],R++).css({opacity:a.handleOpacity}).addClass(a.baseClass+"-handle");T&&la.width(T).height(T)}}function h(){var p=N.getFixed();N.setPressed([p.x,p.y]);N.setCurrent([p.x2,p.y2]);m()}function m(p){if(u)return v(p)}function v(p){var k=N.getFixed(),T=k.h;ta.width(Math.round(k.w)).height(Math.round(T));T=k.x;var la=k.y;a.shade||na.css({top:z(-la),left:z(-T)});ta.css({top:z(la),left:z(T)});a.shade&&ma.updateRaw(k);u||(ta.show(),a.shade?ma.opacity(va):r(va,!0),u=!0);p?a.onSelect.call(ha,ca(k)):
a.onChange.call(ha,ca(k))}function r(p,k,T){if(u||k)a.bgFade&&!T?I.animate({opacity:p},{queue:!1,duration:a.fadeTime}):I.css("opacity",p)}function X(){P=!0;if(a.allowResize)return sa.show(),!0}function U(){P=!1;sa.hide()}function d(p){p?(Ca=!0,U()):(Ca=!1,X())}var u,R=370,P=!1;a.dragEdges&&l.isArray(a.createDragbars)&&t(a.createDragbars);l.isArray(a.createHandles)&&A(a.createHandles);a.drawBorders&&l.isArray(a.createBorders)&&q(a.createBorders);l(document).bind("touchstart.jcrop-ios",function(p){l(p.currentTarget).hasClass("jcrop-tracker")&&
p.stopPropagation()});var da=e().mousedown(fa("move")).css({cursor:"move",position:"absolute",zIndex:360});ia.support&&da.bind("touchstart.jcrop",ia.createDragger("move"));Aa.append(da);U();return{updateVisible:m,update:v,release:function(){U();ta.hide();a.shade?ma.opacity(1):r(1);u=!1;a.onRelease.call(ha)},refresh:h,isAwake:function(){return u},setCursor:function(p){da.css("cursor",p)},enableHandles:X,enableOnly:function(){P=!0},showHandles:function(){P&&sa.show()},disableHandles:U,animMode:d,setBgOpacity:r,
done:function(){d(!1);h()}}}(),ja=function(){function c(r){h(Z(r));return!1}function t(r){r.preventDefault();r.stopPropagation();qa&&(qa=!1,m(Z(r)),D.isAwake()&&a.onSelect.call(ha,ca(N.getFixed())),oa.css({zIndex:290}),l(document).unbind(".jcrop"),h=function(){},m=function(){});return!1}function q(r){h(Z(ia.cfilter(r)));return!1}function A(r){return t(ia.cfilter(r))}var h=function(){},m=function(){},v=a.trackDocument;v||oa.mousemove(c).mouseup(t).mouseout(t);I.before(oa);return{activateHandlers:function(r,
X,U){qa=!0;h=r;m=X;oa.css({zIndex:450});U?l(document).bind("touchmove.jcrop",q).bind("touchend.jcrop",A):v&&l(document).bind("mousemove.jcrop",c).bind("mouseup.jcrop",t);return!1},setCursor:function(r){oa.css("cursor",r)}}}(),Ba=function(){function c(m){A.hide()}function t(m,v,r){a.allowMove&&(N.moveOffset([v,r]),D.updateVisible(!0));m.preventDefault();m.stopPropagation()}function q(m){if(m.ctrlKey||m.metaKey)return!0;var v=(Ea=m.shiftKey?!0:!1)?10:1;switch(m.keyCode){case 37:t(m,-v,0);break;case 39:t(m,
v,0);break;case 38:t(m,0,-v);break;case 40:t(m,0,v);break;case 27:a.allowSelect&&D.release();break;case 9:return!0}return!1}var A=l('<input type="radio" />').css({position:"fixed",left:"-120px",width:"12px"}).addClass("jcrop-keymgr"),h=l("<div />").css({position:"absolute",overflow:"hidden"}).append(A);a.keySupport&&(A.keydown(q).blur(c),Q||!a.fixedSupport?(A.css({position:"absolute",left:"-20px"}),h.append(A).insertBefore(I)):A.insertBefore(I));return{watchKeys:function(){a.keySupport&&(A.show(),
A.focus())}}}();ia.support&&oa.bind("touchstart.jcrop",ia.newSelection);sa.hide();E(!0);var ha={setImage:function(c,t){D.release();H();var q=new Image;q.onload=function(){var A=q.height,h=a.boxWidth,m=a.boxHeight;I.width(q.width).height(A);I.attr("src",c);na.attr("src",c);M(I,h,m);O=I.width();K=I.height();na.width(O).height(K);oa.width(O+ua*2).height(K+ua*2);ka.width(O).height(K);ma.resize(O,K);J();typeof t==="function"&&t.call(ha)};q.src=c},animateTo:function(c,t){var q=c[0]/W,A=c[1]/ba,h=c[2]/W,
m=c[3]/ba;if(!Ca){c=N.flipCoords(q,A,h,m);var v=N.getFixed(),r=[v.x,v.y,v.x2,v.y2],X=a.animationDelay,U=c[0]-r[0],d=c[1]-r[1],u=c[2]-r[2],R=c[3]-r[3],P=0,da=a.swingSpeed;q=r[0];A=r[1];h=r[2];m=r[3];D.animMode(!0);var p=function(){return function(){P+=(100-P)/da;r[0]=Math.round(q+P/100*U);r[1]=Math.round(A+P/100*d);r[2]=Math.round(h+P/100*u);r[3]=Math.round(m+P/100*R);P>=99.8&&(P=100);P<100?(B(r),window.setTimeout(p,X)):(D.done(),D.animMode(!1),typeof t==="function"&&t.call(ha))}}();window.setTimeout(p,
X)}},setSelect:w,setOptions:function(c){aa(c);E()},tellSelect:function(){return ca(N.getFixed())},tellScaled:function(){return N.getFixed()},setClass:function(c){ka.removeClass().addClass(a.baseClass+"-holder").addClass(c)},disable:H,enable:J,cancel:function(){D.done();ja.activateHandlers(null,null)},release:D.release,destroy:function(){ka.remove();y.show();y.css("visibility","visible");l(F).removeData("Jcrop")},focus:Ba.watchKeys,getBounds:function(){return[O*W,K*ba]},getWidgetSize:function(){return[O,
K]},getScaleFactor:function(){return[W,ba]},getOptions:function(){return a},ui:{holder:ka,selection:ta}};C&&ka.bind("selectstart",function(){return!1});y.data("Jcrop",ha);return ha};l.fn.Jcrop=function(F,L){var z;this.each(function(){if(l(this).data("Jcrop")){if(F==="api")return l(this).data("Jcrop");l(this).data("Jcrop").setOptions(F)}else this.tagName=="IMG"?l.Jcrop.Loader(this,function(){l(this).css({display:"block",visibility:"hidden"});z=l.Jcrop(this,F);l.isFunction(L)&&L.call(z)}):(l(this).css({display:"block",
visibility:"hidden"}),z=l.Jcrop(this,F),l.isFunction(L)&&L.call(z))});return this};l.Jcrop.Loader=function(F,L,z){function Y(){aa.complete?(Z.unbind(".jcloader"),l.isFunction(L)&&L.call(aa)):window.setTimeout(Y,50)}var Z=l(F),aa=Z[0];Z.bind("load.jcloader",Y).bind("error.jcloader",function(G){Z.unbind(".jcloader");l.isFunction(z)&&z.call(aa)});aa.complete&&l.isFunction(L)&&(Z.unbind(".jcloader"),L.call(aa))};l.Jcrop.defaults={allowSelect:!0,allowMove:!0,allowResize:!0,trackDocument:!0,baseClass:"jcrop",
addClass:null,bgColor:"black",bgOpacity:.6,bgFade:!1,borderOpacity:.4,handleOpacity:.5,handleSize:null,aspectRatio:0,keySupport:!0,createHandles:"n s e w nw ne se sw".split(" "),createDragbars:["n","s","e","w"],createBorders:["n","s","e","w"],drawBorders:!0,dragEdges:!0,fixedSupport:!0,touchSupport:null,shade:null,boxWidth:0,boxHeight:0,boundary:2,fadeTime:400,animationDelay:20,swingSpeed:3,minSelect:[0,0],maxSize:[0,0],minSize:[0,0],onChange:function(){},onSelect:function(){},onDblClick:function(){},
onRelease:function(){}}})(jQuery);
$(function(){var l="png PNG jpg JPG jpeg JPEG".split(" "),F,L=$(".imagecrop-canvas"),z=L[0];if(void 0!=z){var Y=z.width;heightLimit=z.height;toScale=!0;if(Y==0||heightLimit==0)toScale=!1,Y=heightLimit=600;var Z=function(g){g=g.type.split("/");var C=g[0];F=g[g.length-1];if(C=="image"&&$.inArray(F,l)!=-1)return F=F=="png"||F=="PNG"?"png":"jpeg",!0},aa,G,V=function(g){g.stopPropagation();g.preventDefault();g.target.className="imagecrop-drag";g.type=="dragover"&&(g.target.className="imagecrop-drag hover")},
S,ea,fa,M=new Image,ca=function(g){var C;M.src=g;M.onload=function(){var Q=[Y,heightLimit],y=[M.width,M.height];y[0]>Q[0]&&(G=Q[0]/y[0],y[0]*=G,y[1]*=G);y[1]>Q[1]&&(G=Q[1]/y[1],y[0]*=G,y[1]*=G);y[0]=Math.floor(y[0]);y[1]=Math.floor(y[1]);ea=y;z.width=ea[0];z.height=ea[1];z.getContext("2d").drawImage(M,0,0,ea[0],ea[1]);C=z.toDataURL("image/"+F);toScale?$(".imagecrop-data").val(fa+";"+C):$(".imagecrop-data").val(fa+";"+g);$("#uploaded-image").attr({src:C,style:"display: block"});$("#select-crop-btn").css({display:"inline"});
$("hr").attr({style:"display:block"})}},b=$("#upload-title"),n=$("#upload-container");b.on("click",function(g){n.slideDown("fast",function(){b.html(i18n.upload_image)})});var f=function(g){S&&S.destroy();setTimeout(function(){n.slideUp("fast",function(){b.html("<a>"+i18n.upload_new_image+"</a>")})},500);var C=new FileReader,Q=(g.target.files||g.originalEvent.dataTransfer.files)[0];fa=Q.name;aa=g;g.type=="drop"&&V(g);g=$(".imagecrop-upload");Z(Q)?(C.onload=function(y){ca(y.target.result)},C.readAsDataURL(Q)):
alert(i18n.invalid_image+"\n"+i18n.supported_image_formats+": png, jpeg or jpg");g.val("")},e=$("#select-crop-btn"),w=$("#crop-btn"),B=$("#remove-btn"),H=$('input[name="imagecrop-points"]'),J=function(g){S.release();S.disable();w.css({display:"none"});B.css({display:"none"});e.css({display:"inline"})};e.on("click",function(g){S.enable();var C=S.getBounds();g=C[0]/2;var Q=C[1]/2,y=C[0]/4;C=C[1]/4;S.animateTo([g-y,Q-C,g+y,Q+C]);e.css({display:"none"});w.css({display:"inline"});B.css({display:"inline"})});
w.on("click",function(g){var C=$(".jcrop-holder");g=parseInt(C.css("width").split("px")[0]);var Q=parseInt(C.css("height").split("px")[0]);C=M.width/g;Q=M.height/Q;g=H.val().split(",");var y=g[0],ra=g[1],I=g[3];g=Math.round((g[2]-y)*C);Q=Math.round((I-ra)*Q);S.destroy();J(aa);L.attr({width:g,height:Q});z.getContext("2d").drawImage(M,Math.round(y*C),Math.round(ra*C),g,Q,0,0,g,Q);g=z.toDataURL("image/"+F);ca(g)});B.on("click",J);var x=function(g){H.val(g.x+","+g.y+","+g.x2+","+g.y2)};$("#uploaded-image").on("load",
function(g){g=$(this);S&&(S.destroy(),J(aa));g.Jcrop({onChange:x,opacity:.2,bgFade:!0,bgColor:"black",addClass:"jcrop-light"},function(){S=this;S.getBounds();S.ui.selection.addClass("jcrop-selection");S.disable()})});var E=$(".imagecrop-data").attr("value");(function(g){aa=g})(document.createEvent("Event"));var a=new Image;a.src=E;a.onload=function(){L.attr({width:a.width,height:a.height});z.getContext("2d").drawImage(a,0,0,a.width,a.height);var g=E.split(".");F=g[g.length-1];F=="jpg"&&(F="jpeg");
fa="upload."+F;g=z.toDataURL("image/"+F);ca(g)};$(".imagecrop-drag").on("dragover",V).on("dragleave",V).on("drop",f);$(".imagecrop-upload").on("change",f)}});
